Write the middleware which can change the authentication machanism based on the tenant congig.